(()=>{let e;let t="PubxFloorProvider",o="pbxai_z";(eo=K||(K={})).WIN="WIN",eo.FLOORED="FLOORED",eo.NOBIDS="NOBIDS",(ei=H||(H={})).ERROR="ERROR",ei.WARNING="WARNING";let i=()=>(()=>({splitRate:50,samplingRate:2,enableInstrumentationLogs:false,pbNsKeys:"pbjs",pbNamespace:null,currency:"EUR",modelVersion:"cb_AB_z_dt_0.75_dwt_1.0_dnt_0.1",auctionDelay:150,pubxId:"315b44bc-10e5-45a8-8f58-064d6e7317c0",schema:['bidder','gptSlot','mediaType'],defaultValues:{'*|*|banner':0.0891,'*|/22152718,16833175/w3schools_auto_in_content_php|banner':0.0517,'*|/22152718,16833175/sws-hb//w3schools.com//sidebar_sticky|banner':0.097,'*|/22152718,16833175/sws-hb//w3schools.com//wide_skyscraper|banner':0.0934,'*|/22152718,16833175/sws-hb//w3schools.com//main_leaderboard|banner':0.0998,'*|/22152718,16833175/sws-hb//w3schools.com//try_it_leaderboard|banner':0.0929,'*|/22152718,16833175/sws-hb//w3schools.com//bottom_medium_rectangle|banner':0.0907,'*|/22152718,16833175/sws-hb//w3schools.com//right_bottom_medium_rectangle|banner':0.1626,'kargo|*|banner':4,'ogury|*|banner':4,'gumgum|*|banner':4},defaultSkipRate:50,floorFetchUrl:"https://floor.pbxai.com/?pubxId=315b44bc-10e5-45a8-8f58-064d6e7317c0&page="+window.location.href,floorMin:null,floorEnforcement:{"floorDeals":true},hbPbKey:"hb_pb",pubxSplitKey:"pubx-a",pubxSplitOnValue:"on",pubxSplitTimeoutValue:"dfu",pubxSplitOffValue:"off",pubxOptimizedKey:"pubx-op",pubxOptimizedOnValue:"on",pubxOptimizedOffValue:"off",pubxABSplitAKey:"pubx-exp-A",pubxABSplitBKey:"pubx-exp-B",pubxMvKey:"pubx-m_v",pubxFloorKey:"pubx-floor",pubxFloorMvKey:"pubx-floor-mv",pubxExperiments:{},isTimeoutSegregated:false}))(),r=(e,t)=>{window[t]=window[t]||{},window[t].que=window[t].que||[],window[t].name=t,e.pbNamespace=window[t]},a=e=>({provider:"pubxai",options:{samplingRate:e.samplingRate,pubxId:e.pubxId}}),n=e=>{e.pbNamespace.que.push(function(){let{debug:t,error:o,remotePageError:i}=window.__pubx__.logger;if(!e.pbNamespace.installedModules.includes("pubxaiAnalyticsAdapter")){i({code:J.PUBX_AA_NOT_FOUND});return}{let o=a(e);e.pbNamespace.enableAnalytics(o),t("Enabling Analytics",o)}})},d=e=>{let i={floorProvider:t,modelVersion:e.modelVersion,currency:e.currency,schema:{fields:e.schema},values:e.defaultValues||{"*|banner":.01},skipRate:e.defaultSkipRate||0};return e.isTimeoutSegregated&&(i.skipRate=100,i.floorProvider=o),i},s=e=>{var t;let o={floors:{auctionDelay:e.auctionDelay,endpoint:{url:e.floorFetchUrl},data:d(e)}};return e.floorMin&&(o.floors.floorMin=e.floorMin),e.floorEnforcement&&(o.floors.enforcement=e.floorEnforcement),D(e.pubxExperiments)&&(null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.isABTestEnabled)&&(o=S(o)),o},l=(e,i)=>{window.__pubxLoaded__&&e.pbNamespace.que.push(function(){let{debug:r,error:a,remotePageError:n}=window.__pubx__.logger;if(!e.pbNamespace.installedModules.includes("priceFloors")){n({code:J.PRICE_FLOORS_NOT_FOUND});return}let d=e.pbNamespace.getConfig("floors");d&&d.data&&d.data.floorProvider&&![t,"pbxai",o].includes(d.data.floorProvider)&&n({code:J.NON_PUBX_FLOORS_FOUND,payload:{existingFloors:d}});let s=i(e);window.__pubxFloorsConfig__=s,e.pbNamespace.setConfig(s),r("Setting Floors Config",s)})},u=(e,t)=>void 0!==e.adserverTargeting&&void 0!==e.adserverTargeting[t]&&!isNaN(e.adserverTargeting[t])&&parseFloat(e.adserverTargeting[t])>0,c=(e,t)=>e.filter(e=>e.adUnitCode===t),_=(e,t)=>e.filter(e=>e.adUnitCode===t),p=(e,t)=>e.flatMap(e=>e.bids).filter(e=>e.adUnitCode===t),g=(e,t,o)=>0===e.length&&0===t.length?K.NOBIDS:e.some(e=>u(e,o))?K.WIN:K.FLOORED,f=(e,t,o,i,r,a)=>{try{if(void 0===e||"string"!=typeof t||"string"!=typeof o)throw Error(J.CURRENCY_INVALID_INPUT);if(void 0===i.pbNamespace.convertCurrency)throw Error(J.CURRENCY_MODULE_NOT_INSTALLED);if(t===o)return Number(e);return i.pbNamespace.convertCurrency(e,t,o)}catch(i){return a({code:J.CURRENCY_INVALID_INPUT,adUnitCode:r,payload:{error:i,value:e,fromCurrency:t,toCurrency:o}}),Number(e)}},b=(e,t)=>[...e,...t],m=e=>{if(void 0!==e)return{floorValue:e.floorValue,floorRule:e.floorRule,floorCurrency:e.floorCurrency}},O=(e,t,o,i,r,a,n)=>{var d;let{remoteAucError:s,remoteAucEvent:l}=n,{hbPbKey:c}=a,_,p,g,O,R={};switch(r){case K.WIN:let h=t.filter(e=>u(e,c)).sort((e,t)=>parseFloat(t.adserverTargeting[c])-parseFloat(e.adserverTargeting[c]))[0];_=parseFloat(h.adserverTargeting[c]),g=h.currency,O=h.floorData,R=h.adserverTargeting;break;case K.FLOORED:let v=b(o,t).sort((t,o)=>f(o.originalCpm,o.originalCurrency,a.currency,a,e.code,s)-f(t.originalCpm,t.originalCurrency,a.currency,a,e.code,s))[0];_=v.originalCpm,g=v.originalCurrency,O=v.floorData,R=v.adserverTargeting||{};break;case K.NOBIDS:let E;if(g=window.__pubxFloorsConfig__?window.__pubxFloorsConfig__.floors.data.currency:a.currency,e6(e)){_=.01;break}let A=k(e.code);if(E=A?eH(A,window.__nextfloorsConfig__)||eH(A,window.__pubxFloorsConfig__):eK(e.code,window.__nextfloorsConfig__)||eK(e.code,window.__pubxFloorsConfig__)){_=E;break}window.__pubx__.logger.debug("NOBID floor rule not found for adUnit",e.code);let N=i.map(e=>{var t;if("function"!=typeof e.getFloor)return;let o=null===(t=e.getFloor({size:"*",mediaType:"banner"}))||void 0===t?void 0:t.floor;return"number"==typeof o&&o>=0?o:void 0}).filter(e=>void 0!==e);if(N.length>0){_=N.reduce((e,t)=>e+t,0)/N.length;break}window.__pubx__.logger.debug("NOBID getFloor() not found for adUnit",e.code),a.defaultValues&&void 0!==a.defaultValues["*|banner"]?_=a.defaultValues["*|banner"]:(window.__pubx__.logger.debug("NOBID TAG_DEFAULT_VALUES_NOT_FOUND for adUnit",e.code),_=.01)}return D(a.pubxExperiments)&&(null===(d=window.__pubx__.abTestConfig)||void 0===d?void 0:d.isABTestEnabled)&&Object.assign(R,ta(a)),l({type:"pbBid",data:{adUnitCode:e.code,status:r,bidCurrency:g,bidValue:parseFloat(_.toFixed(4)),pubCurrency:a.currency,floorData:m(O),adserverTargeting:R}}),p=_,r===K.FLOORED&&(_=f(_,g,a.currency,a,e.code,s)),{bidCpmValue:parseFloat(_.toFixed(4)),originalBidCpmValue:parseFloat(p.toFixed(4)),bidCurrency:g,floorData:m(O),adserverTargeting:R}},R=(e,t,o,i)=>{var r,a,n,d;let{adUnitBidsReceived:s,adUnitBidsRejected:l,adUnitBidsFromBidderRequests:u}=T(e,t),c=t.auctionId,_=g(s,l,o.hbPbKey),p=null===(a=null===(r=u[0])||void 0===r?void 0:r.floorData)||void 0===a?void 0:a.floorProvider,f=null===(d=null===(n=u[0])||void 0===n?void 0:n.floorData)||void 0===d?void 0:d.modelVersion,b=e6(e),{bidCpmValue:m,originalBidCpmValue:R,bidCurrency:h,floorData:v,adserverTargeting:E}=O(e,s,l,u,_,o,i);return{auctionId:c,adUnit:e,adUnitStatus:_,bidCpmValue:m,originalBidCpmValue:R,bidCurrency:h,adserverTargeting:E,floorData:v,floorProvider:p,floorSkipStatus:b,floorModelVersion:f}},h=e=>e.adUnits.flatMap(e=>e.bids).map(e2).filter(e=>void 0!==e)[0],v=(e,t)=>{let o=e.bids.map(e2).filter(e=>void 0!==e)[0];if(void 0===o)throw t.remoteAucError({code:J.MODEL_VERSION_NOT_FOUND_READ,adUnitCode:e.code}),Error(eg[J.MODEL_VERSION_NOT_FOUND_READ].message+" for adUnit "+e.code);return o},E=e=>e.includes("_AB_")?e.split("_AB_")[1].split("_")[0]:void 0,A=(e,t,o)=>{switch(o){case K.WIN:return e.includes("_dwt_")?parseFloat(e.split("_dwt_")[1].split("_")[0]):t.winBidMultiplier;case K.FLOORED:return e.includes("_dt_")?parseFloat(e.split("_dt_")[1].split("_")[0]):t.flooredBidMultiplier;case K.NOBIDS:return e.includes("_dnt_")?parseFloat(e.split("_dnt_")[1].split("_")[0]):t.noBidMultiplier}},N=(e,t,o)=>{if(e.includes("_fm_"))return parseFloat(e.split("_fm_")[1].split("_")[0]);if(!t.pmacFloorMultiplier)throw o({code:J.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG}),Error(eg[J.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG].message);return t.pmacFloorMultiplier},I=(e,t,o)=>{let i=void 0!==e.mediaTypes.banner,r=e.bids.some(e=>!!e.bidder),a=e9(e);if(!t&&a)throw o({code:J.PUBX_OFF_FLOORS_FOUND,adUnitCode:e.code}),Error(eg[J.PUBX_OFF_FLOORS_FOUND].message+" for adUnitCode "+e.code);return i&&r&&(!t&&!a||t&&a)},y=e=>e?e.filter(e=>!!e.originalCpm):[],w=(e,t,o,i)=>{let{remoteAucError:r}=i,{bidCpmValue:a,adUnitStatus:n,adUnit:d,auctionId:s}=e;ef({remoteError:r,code:J.UNCAUGHT_ERROR,location:"triggerPmac"},()=>{e0(s,d.code,a,n,o,N(t,o,r),eB(t,o),i)}),d.code;let l=parseFloat((a*A(t,o,n)).toFixed(4));return e6(d)?void 0:{adUnitCode:d.code,floorValue:l,status:n}},T=(e,t)=>{let o=t.auctionId,i=c(t.bidsReceived,e.code);return{auctionId:o,adUnitBidsReceived:i,adUnitBidsRejected:_(y(t.bidsRejected),e.code),adUnitBidsFromBidderRequests:p(t.bidderRequests,e.code)}},C=e=>e.type===H.ERROR&&e.arguments.length>0&&e.arguments[0].includes("Price Floors"),x=e=>{let t=e[0],o="";if(e.length>1)try{o=JSON.stringify(e[1])}catch(t){o=e[1]}window.__pubx__.logger.error("pubx: Price Floors Error",e),window.__pubx__.logger.remotePageError({code:J.FLOORS_RESPONSE_INVALID,payload:{error:t,message:o}})},U=e=>{e.pbNamespace.que.push(()=>{e.pbNamespace.onEvent("auctionInit",t=>{!function(e,t){var o,i,r,a;o=this,i=void 0,r=void 0,a=function*(){let{debug:o,error:i}=window.__pubx__.logger;if(100*Math.random()<100/e.samplingRate/100&&localStorage.getItem("lastCallDate")!==new Date().toLocaleDateString()){o("Telemetry Triggered");let r=function(e,t){let o=[],[i,r]=function(e){try{let t=e.adUnits||[],o=new Set,i=[];return t.forEach(function(e){let t;let r=Object.keys(e.mediaTypes||{});t=e.mediaTypes.banner?e.mediaTypes.banner.sizes.map(e=>e.join("x")):[];let a=k(e.code),n=a?a.getAdUnitPath()===e.code?a.getSlotElementId():a.getSlotElementId()===e.code?a.getAdUnitPath():"":"";i.push({code:e.code,sizes:t,gamSlot:n,media_type:r}),e.bids.forEach(function(e){o.add(e.bidder)})}),[{adUnits:i,bidders:Array.from(o)},null]}catch(e){return[{adUnits:[],bidders:[]},"Error in getAdUnitAndBidders, reason:"+e.message]}}(t);null!==r&&o.push(r);let[a,n]=function(e){try{return[{PubxaiAA:!!e.pbNamespace.installedModules.includes("pubxaiAnalyticsAdapter"),PriceFloors:!!e.pbNamespace.installedModules.includes("priceFloors"),PubxaiRTD:!!e.pbNamespace.installedModules.includes("pubxaiRtdProvider")},null]}catch(e){return[{},"Error in getPubxModuleStatus, reason:"+e.message]}}(e);null!==n&&o.push(n);let d=ey();return{pubx_id:e.pubxId,pbjs_version:e.pbNamespace.version||"",installed_modules:e.pbNamespace.installedModules.filter(e=>!e.includes("BidAdapter"))||[],ad_units:i.adUnits,bidders:i.bidders,pubx_modules_status:a,errors:o.length>0?o:null,timestamp:new Date().toISOString(),page_info:em(d)}}(e,t);try{navigator.sendBeacon("https://analytics.pbxai.com/telemetry",new Blob([JSON.stringify(r)],{type:"application/json"}))?(localStorage.setItem("lastCallDate",new Date().toLocaleDateString()),o("Telemetry data sent successfully using sendBeacon",r)):o("Telemetry API call failed using sendBeacon")}catch(e){i("Telemetry API call failed due to an error:",e)}}},new(r||(r=Promise))(function(e,t){function n(e){try{s(a.next(e))}catch(e){t(e)}}function d(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var o;t.done?e(t.value):((o=t.value)instanceof r?o:new r(function(e){e(o)})).then(n,d)}s((a=a.apply(o,i||[])).next())})}(e,t=Object.assign({},t))}),e.pbNamespace.getEvents().filter(e=>"auctionDebug"===e.eventType).map(e=>e.args).filter(C).forEach(e=>x(e.arguments)),e.pbNamespace.onEvent("auctionDebug",e=>{C(e)&&x(e.arguments)})})},S=e=>{var t,o,i,r;if(!(null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.isABTestEnabled)||(null===(o=window.__pubx__.abTestConfig)||void 0===o?void 0:o.testBucket)!=="A"&&(null===(i=window.__pubx__.abTestConfig)||void 0===i?void 0:i.testBucket)!=="B")return e;let a=(null===(r=window.__pubx__.abTestConfig)||void 0===r?void 0:r.testBucket)==="A";return e.floors.enforcement?e.floors.enforcement.enforceJS=a:e.floors.enforcement={enforceJS:a},e},D=e=>!!e&&"number"==typeof(null==e?void 0:e.enforceJsSplit)&&e.enforceJsSplit>0,F=e=>{let{floorData:t}=e;if(t&&("timeout"===t.fetchStatus||"error"===t.fetchStatus))return t.fetchStatus},P=e=>{let t=e.bids.some(F),i=e.bids.some(e=>{var t;return(null===(t=null==e?void 0:e.floorData)||void 0===t?void 0:t.floorProvider)===o});return t||i},L=()=>(()=>({flooredBidMultiplier:0.75,noBidMultiplier:0.1,winBidMultiplier:1.0,pmacFloorMultiplier:0.5,decayRate:1.0,gamBuckets:[{'pbx_a0d_n':[0,0.03]},{'pbx_a1d_n':[0.03,0.06]},{'pbx_a2d_n':[0.06,0.09]},{'pbx_a3d_n':[0.09,0.12]},{'pbx_a4d_n':[0.12,0.15]},{'pbx_b0d_n':[0.15,0.2]},{'pbx_b1d_n':[0.2,0.25]},{'pbx_b2d_n':[0.25,0.3]},{'pbx_b3d_n':[0.3,0.35]},{'pbx_b4d_n':[0.35,0.4]},{'pbx_b5d_n':[0.4,0.45]},{'pbx_b6d_n':[0.45,0.5]},{'pbx_b7d_n':[0.5,0.55]},{'pbx_b8d_n':[0.55,0.6]},{'pbx_b9d_n':[0.6,0.65]},{'pbx_b10d_n':[0.65,0.7]},{'pbx_b11d_n':[0.7,0.75]},{'pbx_b12d_n':[0.75,0.8]},{'pbx_b13d_n':[0.8,0.85]},{'pbx_b14d_n':[0.85,0.9]},{'pbx_b15d_n':[0.9,0.95]},{'pbx_b16d_n':[0.95,1]},{'pbx_c0d_n':[1,1.1]},{'pbx_c1d_n':[1.1,1.2]},{'pbx_c2d_n':[1.2,1.3]},{'pbx_c3d_n':[1.3,1.4]},{'pbx_c4d_n':[1.4,1.5]},{'pbx_c5d_n':[1.5,1.6]},{'pbx_c6d_n':[1.6,1.7]},{'pbx_c7d_n':[1.7,1.8]},{'pbx_c8d_n':[1.8,1.9]},{'pbx_c9d_n':[1.9,2]},{'pbx_d0d_n':[2,2.25]},{'pbx_d1d_n':[2.25,2.5]},{'pbx_d2d_n':[2.5,2.75]},{'pbx_d3d_n':[2.75,3]},{'pbx_d4d_n':[3,3.25]},{'pbx_d5d_n':[3.25,3.5]},{'pbx_d6d_n':[3.5,3.75]},{'pbx_d7d_n':[3.75,4]},{'pbx_d8d_n':[4,4.25]},{'pbx_d9d_n':[4.25,4.5]},{'pbx_d10d_n':[4.5,4.75]},{'pbx_d11d_n':[4.75,5]},{'pbx_d12d_n':[5,111111]}]}))(),B=()=>{window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[]},M=e=>{let t=i();r(t,e);let o=L();return B(),Object.assign(Object.assign({},t),o)},G=(e,t)=>{let{error:o}=window.__pubx__.logger,i=googletag.pubads().getSlots(),r=[];return e.forEach(e=>{let t=i.find(t=>t.getAdUnitPath()===e||t.getSlotElementId()===e);void 0!==t&&r.push({adUnitCode:e,slot:t})}),r},k=e=>{if((null==googletag?void 0:googletag.pubads)&&"function"==typeof googletag.pubads)return googletag.pubads().getSlots().find(t=>t.getAdUnitPath()===e||t.getSlotElementId()===e)},V=(e,t,o)=>{e.pbNamespace.que.push(()=>{e.pbNamespace.onEvent("auctionEnd",i=>{try{i=Object.assign({},i);let{makeRemoteAucError:r,makeRemoteAucEvent:a,error:n}=window.__pubx__.logger,d=r(i),s=a(i),l={remoteAucError:d,remoteAucEvent:s};ef({remoteError:d,code:J.UNCAUGHT_ERROR,location:"readAndSetKvsAuction"},()=>{let{variant:r}=window.__pubx__,a=r.includes("STATIC"),n="PB_GAM_CUSTOM_MG"===r,s="PB_GAM_CUSTOM_RELEVANT_MEDIA"===r,u=n||s||a;window.__pubx__.logger.debug("pubx: setPubxLoadedFromAuctionData",u),u&&(window.__pubxLoaded__=i.adUnits.some(e9),window.__pubx__.logger.debug("pubx: window.__pubxLoaded__",window.__pubxLoaded__));let c=window.__pubxLoaded__;o&&(i=o(i,e,l)),i.adUnits.filter(e=>I(e,c,l.remoteAucError)).map(o=>{ef({remoteError:d,code:J.UNCAUGHT_ERROR,location:"readAndSetKvsAdUnit"},()=>{var r;let a=tr(o,e,l);D(e.pubxExperiments)&&(null===(r=window.__pubx__.abTestConfig)||void 0===r?void 0:r.isABTestEnabled)&&Object.assign(a,ta(e));let d=R(o,i,e,l);if(e9(o)){if(n){let t={vendor:"pubxai",auctionId:i.auctionId,transactionId:o.transactionId||ey(),billingId:ey(),type:"impression"};e.pbNamespace.rp.billableEvent(t),window.__pubx__.logger.debug("pubx: billable event raised for adUnit:",o.code,t)}let t=v(o,l);Object.assign(a,e7(t,e,o));let r=w(d,t,e,l);r&&Object.assign(a,te(r,t,e,l.remoteAucError))}t&&t(o,i.auctionId,a,e,l)})})})}catch(e){window.__pubx__.logger.error(e)}})})},j=(e,t)=>0===e?t[0]:t.find(t=>{let o=Object.keys(t)[0],[i,r]=t[o];return e>i&&e<=r}),W=(e,t,o)=>{let i=j(e.floorValue,t.gamBuckets);if(void 0===i)throw o({code:J.GAM_BUCKET_NOT_FOUND,adUnitCode:e.adUnitCode,payload:{floorWithStatus:e}}),Error(eg[J.GAM_BUCKET_NOT_FOUND].message+" for "+JSON.stringify(e));let r=Object.keys(i)[0],a=e.status===K.WIN?"_w":e.status===K.FLOORED?"_f":"_n";return r.split("_n")[0]+a},X=e=>{e.pbNamespace.que.push(function(){let{error:e,remotePageError:t}=window.__pubx__.logger;googletag.cmd.push(()=>{googletag.pubads().addEventListener("slotAdded",e=>{ef({remoteError:t,code:J.UNCAUGHT_GAM_ERROR,location:"setupEventHandlersForGamQue"},()=>{let t=e.slot,{__pubxGamQue__:o}=window;o.filter(e=>t&&(t.getAdUnitPath()===e.adUnitCode||t.getSlotElementId()===e.adUnitCode)).forEach(e=>{if(e.cmd()){let t=o.findIndex(t=>t.id===e.id);t>-1&&o.splice(t,1)}})})})})})};(er=Y||(Y={})).DBM_HEURISTICS="dbm_heuristics",er.PMAC_DATA="pmac_data";let q=()=>{try{[localStorage,sessionStorage].forEach(e=>{e.removeItem("pbx:dpbid"),e.removeItem("pubx:pmac"),e.removeItem("pubx:extraData")})}catch(e){console.error(e)}};var K,H,Y,z,J,$,Q,Z,ee,et,eo,ei,er,ea,en,ed,es,el,eu,ec,e_=function(e,t,o,i){return new(o||(o=Promise))(function(r,a){function n(e){try{s(i.next(e))}catch(e){a(e)}}function d(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(n,d)}s((i=i.apply(e,t||[])).next())})},ep=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(o[i[r]]=e[i[r]]);return o};(ea=z||(z={})).IN_PROGRESS="IN_PROGRESS",ea.SUCCESS="SUCCESS",ea.ERROR="ERROR",(en=J||(J={})).GPT_SLOT_NOT_FOUND="GPT_SLOT_NOT_FOUND",en.GAM_QUE_GPT_SLOT_NOT_FOUND="GAM_QUE_GPT_SLOT_NOT_FOUND",en.GAM_BUCKET_NOT_FOUND="GAM_BUCKET_NOT_FOUND",en.CALC_FLOOR_NOT_FOUND="CALC_FLOOR_NOT_FOUND",en.IMPROVEMEDIA_API_NOT_FOUND="IMPROVEMEDIA_API_NOT_FOUND",en.INVESTING_FILTER_NOT_FOUND="INVESTING_FILTER_NOT_FOUND",en.PUBX_AA_NOT_FOUND="PUBX_AA_NOT_FOUND",en.PRICE_FLOORS_NOT_FOUND="PRICE_FLOORS_NOT_FOUND",en.NON_PUBX_FLOORS_FOUND="NON_PUBX_FLOORS_FOUND",en.CURRENCY_INVALID_INPUT="CURRENCY_INVALID_INPUT",en.CURRENCY_MODULE_NOT_INSTALLED="CURRENCY_MODULE_NOT_INSTALLED",en.GET_FLOOR_NOT_FOUND="GET_FLOOR_NOT_FOUND",en.NO_BID_FLOOR_RULE_NOT_FOUND="NO_BID_FLOOR_RULE_NOT_FOUND",en.TAG_DEFAULT_VALUES_NOT_FOUND="TAG_DEFAULT_VALUES_NOT_FOUND",en.PUBX_OFF_FLOORS_FOUND="PUBX_OFF_FLOORS_FOUND",en.MODEL_VERSION_NOT_FOUND_READ="MODEL_VERSION_NOT_FOUND_READ",en.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG="PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG",en.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE="INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE",en.MISSING_ADUNIT_FLOOR_RESPONSE="MISSING_ADUNIT_FLOOR_RESPONSE",en.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE="PMAC_FLOOR_RESPONSE_NOT_AVAILABLE",en.UNCAUGHT_ERROR="UNCAUGHT_ERROR",en.UNCAUGHT_GAM_ERROR="UNCAUGHT_GAM_ERROR",en.PUBX_ANALYTICS_ERROR="PUBX_ANALYTICS_ERROR",en.FLOORS_RESPONSE_INVALID="FLOORS_RESPONSE_INVALID",(ed=$||($={})).INFO="INFO",ed.WARNING="WARNING",ed.ERROR="ERROR",ed.FATAL="FATAL";let eg={[J.GPT_SLOT_NOT_FOUND]:{message:"GPT Slot not found",severity:$.WARNING},[J.GAM_QUE_GPT_SLOT_NOT_FOUND]:{message:"Gam Que: GPT Slot not found",severity:$.ERROR},[J.GAM_BUCKET_NOT_FOUND]:{message:"GAM Bucket not found",severity:$.WARNING},[J.CALC_FLOOR_NOT_FOUND]:{message:"floorWithStatus not found",severity:$.FATAL},[J.IMPROVEMEDIA_API_NOT_FOUND]:{message:"lwhbim.adServerKeywordsAdUnit is not defined",severity:$.ERROR},[J.INVESTING_FILTER_NOT_FOUND]:{message:"window._imhb_auctions is not defined",severity:$.ERROR},[J.PUBX_AA_NOT_FOUND]:{message:"pubxaiAnalyticsAdapter module is not installed",severity:$.WARNING},[J.PRICE_FLOORS_NOT_FOUND]:{message:"priceFloors module is not installed",severity:$.WARNING},[J.NON_PUBX_FLOORS_FOUND]:{message:"Non-pubx floor provider present",severity:$.WARNING},[J.CURRENCY_INVALID_INPUT]:{message:"Invalid input types for currency conversion",severity:$.WARNING},[J.CURRENCY_MODULE_NOT_INSTALLED]:{message:"currency module of prebid.js is not installed",severity:$.WARNING},[J.GET_FLOOR_NOT_FOUND]:{message:"calc nbids - None of bidderRequests.bids.getFloor() is defined",severity:$.WARNING},[J.NO_BID_FLOOR_RULE_NOT_FOUND]:{message:"calc nbids - Floor rule not found in __pubxFloorsConfig__ and __nextfloorsConfig__",severity:$.WARNING},[J.TAG_DEFAULT_VALUES_NOT_FOUND]:{message:"defaultValues of *|banner in config is undefined",severity:$.ERROR},[J.PUBX_OFF_FLOORS_FOUND]:{message:"pubxLoaded is false but has floorData",severity:$.FATAL},[J.MODEL_VERSION_NOT_FOUND_READ]:{message:"floorModelVersion is undefined but adUnit.bids is not",severity:$.FATAL},[J.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG]:{message:"PMAC floor multiplier not found in config",severity:$.ERROR},[J.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE]:{message:"Invalid schema fields in floor rules response, expected only ['gptSlot']",severity:$.ERROR},[J.MISSING_ADUNIT_FLOOR_RESPONSE]:{message:"adUnitCode not found in floor rules response",severity:$.ERROR},[J.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE]:{message:"Floors Reponse not available for pmac",severity:$.WARNING},[J.UNCAUGHT_ERROR]:{message:"Uncaught Error",severity:$.ERROR},[J.UNCAUGHT_GAM_ERROR]:{message:"Uncaught GAM Error",severity:$.ERROR},[J.PUBX_ANALYTICS_ERROR]:{message:"Pubx Analytics Error",severity:$.ERROR},[J.FLOORS_RESPONSE_INVALID]:{message:"Floors Response Invalid",severity:$.ERROR}},ef=({remoteError:e,code:t,location:o},i)=>{try{i()}catch(i){window.__pubx__.logger.error(i),e({code:t,payload:{name:i.name,message:i.message,location:o}})}},eb=e=>{let{__pubx__:{variant:t,version:o}}=window;return{variant:t,version:o,loadTime:window.__loadTime__,pbVersion:e.pbNamespace.version,pbNamespace:e.pbNamespace.name}},em=e=>({userAgent:navigator.userAgent,host:window.location.host,path:window.location.pathname,pageId:e,doNotTrack:navigator.doNotTrack}),eO=(e,t)=>e.pbNamespace.getEvents().filter(e=>"auctionEnd"===e.eventType).findIndex(e=>e.args.auctionId===t),eR=e=>e.pbNamespace.getEvents().filter(e=>"auctionInit"===e.eventType).length,eh=e=>{let{code:t,adUnitCode:o,payload:i}=e,{message:r,severity:a}=eg[t];return{code:t,severity:a,message:r,adUnitCode:o,payload:i}},ev=(e,t,o,i)=>{let r=t;if(e.adUnitCode){let{adUnits:t,bidderRequests:o,bidsReceived:i,bidsRejected:a}=r;r=Object.assign(Object.assign({},r),{adUnits:t.filter(t=>t.code===e.adUnitCode),bidderRequests:o.map(t=>Object.assign(Object.assign({},t),{bids:t.bids.filter(t=>t.adUnitCode===e.adUnitCode)})),bidsReceived:i.filter(t=>t.adUnitCode===e.adUnitCode),bidsRejected:a?a.filter(t=>t.adUnitCode===e.adUnitCode):void 0})}let{auctionId:a,adUnits:n,bidderRequests:d,bidsReceived:s,bidsRejected:l}=r,u={adUnits:n.map(({code:e,sizes:t,bids:o,mediaTypes:i})=>({code:e,mediaTypes:Object.keys(i)})),bidderRequestsCount:d.length,bidsReceived:s.map(({adUnitCode:e,adserverTargeting:t,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n})=>({adUnitCode:e,adserverTargeting:t?{hb_pb:t.hb_pb}:void 0,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n?{floorValue:n.floorValue}:void 0})),bidsRejected:l?l.map(({adUnitCode:e,adserverTargeting:t,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n})=>({adUnitCode:e,adserverTargeting:t?{hb_pb:t.hb_pb}:void 0,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n?{floorValue:n.floorValue}:void 0})):void 0};return Object.assign({previousAuctionCount:eO(o,a),auctionId:a,auctionInfo:u,modelVersion:h(t)},eE(e,o,i))},eE=(e,t,o)=>({type:"error",isPubxEnabled:window.__pubxLoaded__,pubxId:t.pubxId,tagInfo:eb(t),pageInfo:em(o),errorData:eh(e),timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now()}),eA=e=>{let t=e.pbNamespace.getConfig("floors");return t&&t.data&&t.data.floorProvider?t.data.floorProvider:void 0},eN=(e,t,o,i)=>{let{auctionId:r,adUnits:a,bidsReceived:n,bidsRejected:d,bidderRequests:s}=e,l={adUnitCount:a.length,bidCount:n.length+(d?d.length:0),bidders:[...new Set(s.map(({bidderCode:e})=>e))]};return{type:"event",isPubxEnabled:window.__pubxLoaded__,pubxId:t.pubxId,loadedBeforePb:window.__loadedBeforePb__,tagInfo:eb(t),floorProvider:eA(t),pageInfo:em(i),missedAuctionCount:o,timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now(),previousAuctionCount:eO(t,r),auctionId:r,auctionInfo:l,modelVersion:h(e),pbBidData:[],gamTargetingData:[]}},eI=e=>{let{severity:t}=eg[e.code];return!1},ey=()=>{let e=new Date().getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){let i=16*Math.random();return e>0?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"===o?i:3&i|8).toString(16)})},ew=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e),eT=()=>{window.__pubxGamQue__.filter(e=>!e.logged).forEach(e=>{e.error(),e.logged=!0})},eC=e=>{let t=[],o=[],i=[],r=eR(e),a=ey(),n=e.enableInstrumentationLogs&&1/e.samplingRate>Math.random();window.__pubxLogsEnabled__=n;let d=e=>JSON.stringify(e).length,s=(e,t)=>{let o=[],i=0,r=[];for(let a of e){let e=d([a]);i+e>t?(r.push(o),o=[a],i=e):(o.push(a),i+=e)}return o.length>0&&r.push(o),r},l=(e,t)=>{0!==e.length&&s(e,65536).map(e=>{JSON.parse(JSON.stringify(e));let o=new Blob([JSON.stringify(e)],{type:"application/json"});navigator.sendBeacon(t,o)})},u=()=>!!navigator.sendBeacon&&!!document.visibilityState;u()&&document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(eT(),l([...t,...o,...i],"https://analytics.pbxai.com/logs"),[t,o,i].map(e=>e.splice(0)))});let c=new URLSearchParams(window.location.search),_=(...e)=>{e=e.filter(e=>void 0!==e),c.has("pubx_debug")&&console.error("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","ERROR:",...e)};return{debug:(e,...t)=>{c.has("pubx_debug")&&console.info("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","INFO:",e,...t)},error:_,makeRemoteAucError:o=>i=>{let{code:r,adUnitCode:d,payload:s}=i;_(eg[r].message,d,s),u()&&(n||eI(i))&&t.push(ev(i,o,e,a))},remotePageError:t=>{let{code:i,adUnitCode:r,payload:d}=t;_(eg[i].message,r,d),u()&&(n||eI(t))&&o.push(eE(t,e,a))},makeRemoteAucEvent:t=>{let o=(o,i)=>{let n=i.find(e=>e.auctionId===t.auctionId);if(void 0===n&&(n=eN(t,e,r,a),i.push(n)),"pbBid"===o.type)n.pbBidData.push(o.data);else if("gamTargeting"===o.type){let e=o.data,t=n.gamTargetingData.find(t=>t.adUnitCode===e.adUnitCode);void 0===t?n.gamTargetingData.push(e):Object.assign(t,e)}};return e=>{u()&&n&&o(e,i)}}}},ex=e=>{window.__pubx__.logger.debug("version:",window.__pubx__.variant+"_"+window.__pubx__.version+"_"+e.name)},eU=()=>{window.__loadTime__=window.__loadTimestamp__?Date.now()-window.__loadTimestamp__:-1,window.__loadTimestamp__=Date.now()},eS=(e,t)=>{let o=window.__pubxFloorsConfig__.floors,{auctionDelay:i,endpoint:r,data:a}=o,n=ep(o,["auctionDelay","endpoint","data"]);window.__nextfloorsConfig__={floors:Object.assign(Object.assign({},n),{data:e})}},eD=(e,t)=>{let o=t.pbNamespace.getConfig("floors"),{auctionDelay:i,endpoint:r,data:a}=o,n=ep(o,["auctionDelay","endpoint","data"]);window.__nextfloorsConfig__={floors:Object.assign(Object.assign({},n),{data:e})}},eF=e=>window.__pmacCpmHistory__[e],eP=e=>{let t=eF(e);return t?t.history:[]},eL=(e,t,o,i)=>{let{debug:r}=window.__pubx__.logger,{__pmacCpmHistory__:a}=window;void 0===a[t]&&(a[t]={history:[],decayRate:void 0});let n={auctionId:e,cpm:o,adUnitStatus:i};eP(t).push(n),r("Update Pmac history",t,n)},eB=(e,t)=>{let{debug:o}=window.__pubx__.logger;return e.includes("_dr_")?-1*parseFloat(e.split("_dr_")[1].split("_")[0]):null!==t.decayRate?-1*t.decayRate:(o("No decay rate in floor model version or config",e),null)},eM=(e,t,o)=>(e=0===e?.01:e)*Math.exp(t*o),eG=(e,t)=>{let{debug:o}=window.__pubx__.logger,i=eF(e);i.decayRate=t,o("Assigning decay rate",e,i.decayRate)},ek=e=>0!==eP(e).length,eV=(e,t)=>{let{remoteAucError:o}=t,{__pmacCpmHistory__:i}=window,r=Object.keys(i);"PB_GAM_CUSTOM_AY"===window.__pubx__.variant?r.forEach(o=>{ek(o)&&eY(o,void 0,ez(o,e),t)}):G(r,o).forEach(({adUnitCode:o,slot:i})=>{ek(o)&&eY(o,i,ez(o,e),t)})},ej=e=>"|banner"+(e.fields.includes("size")?"|*":""),eW=(e,t,o)=>{let i=Object.keys(t),r=ej(o);return i.find(t=>[e.getAdUnitPath()+r,e.getSlotElementId()+r].includes(t))},eX=(e,t,o)=>Object.keys(t).find(t=>t.split(ej(o))[0]===e),eq=(e,t,o)=>Object.keys(t).find(t=>t.split(ej(o))[0]===ts(e)),eK=(e,t)=>{if(t){let o=eX(e,t.floors.data.values,t.floors.data.schema);if(o)return t.floors.data.values[o]}},eH=(e,t)=>{if(t){let o=eW(e,t.floors.data.values,t.floors.data.schema);if(o)return t.floors.data.values[o]}},eY=(e,t,o,i)=>{let r;let{remoteAucError:a}=i,{__nextfloorsConfig__:n}=window;if(void 0===n)throw Error("__nextfloorsConfig__ undefined. Skip updating adUnit floors config");let{floors:{data:{values:d,schema:s}}}=n;if(void 0===(r="PB_GAM_CUSTOM_AY"===window.__pubx__.variant?eq(e,d,s):eW(t,d,s))){a({code:J.MISSING_ADUNIT_FLOOR_RESPONSE,adUnitCode:e});return}d[r]=o},ez=(e,t)=>{let{decayRate:o,history:i}=eF(e),[r,a]=[i[0].cpm,i.length],n=eM(r,o,a)*t;return n<.01?.01:parseFloat(n.toFixed(4))},eJ=(e,t)=>e_(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger;try{let o=yield fetch(e.floorFetchUrl),i=yield o.json();t("PMAC Received floor rules",i),eS(i,e)}catch(i){let o=d(e);t("PMAC Default floor rules",o),eS(o,e)}}),e$=(e,t)=>e_(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger;try{let o=yield fetch(e.floorFetchUrl),i=yield o.json();t("PMAC Received floor rules",i),eD(i,e)}catch(i){let o=d(e);t("PMAC Default floor rules",o),eD(o,e)}}),eQ=(e,t)=>e_(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger,o=e.pbNamespace.getConfig("floors");window.__nextfloorsConfig__={floors:o},t("Reading floors from config",o)}),eZ=()=>e_(void 0,void 0,void 0,function*(){let e=()=>{let{debug:e}=window.__pubx__.logger,t=window.__pubxFloorsConfig__;if(!t)throw Error("__pubxFloorsConfig__ not defined. Skip pmac");window.__nextfloorsConfig__=t,e("Reading floors from rtd module",t)};e(),window.addEventListener("floorsApi",t=>{t.detail.status===z.SUCCESS&&e()})}),e0=(e=null,(t,o,i,r,a,n,d,s)=>e_(void 0,void 0,void 0,function*(){let{remoteAucError:u}=s,{variant:c,isRtd:_}=window.__pubx__;if(null===d){window.__pubx__.logger.debug("pubx: PMAC Turned off");return}null===e&&(e=_?eZ():"PB_GAM_CUSTOM_AZ"===c?eQ(a,s):"PB_GAM_CUSTOM_MG"==c||c.includes("STATIC")?e$(a,s):eJ(a,s)),yield e,window.__pubx__.logger.debug("pubx:","triggering pmac"),eL(t,o,i,r),eG(o,d);let{__nextfloorsConfig__:p}=window;if(void 0===p)throw u({code:J.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE,adUnitCode:o}),Error("__nextfloorsConfig__ undefined. Skip updating floors config");"PB_GAM_CUSTOM_AY"===c?(eV(n,s),l(a,e=>p)):googletag.cmd.push(()=>{ef({remoteError:u,code:J.UNCAUGHT_GAM_ERROR,location:"updateSetFloor"},()=>{eV(n,s),l(a,e=>p)})})})),e1=()=>({debug:(e,...t)=>{},error:(...e)=>{},makeRemoteAucError:e=>e=>{},remotePageError:e=>{},makeRemoteAucEvent:e=>e=>{}}),e3=(e,t)=>{q(),window.__pubxFloors__={},!1!==window.__loadedBeforePb__&&(window.__loadedBeforePb__=void 0===e.pbNamespace.version),window.__pmacCpmHistory__={},eU(),window.__pubx__={variant:t,version:"1746178396050",isRtd:!1},window.__pubx__.logger||(window.__pubx__.logger=e1()),function(e){if(window.__pubxLoaded__&&D(e.pubxExperiments)&&tc(e.pubxExperiments.enforceJsSplit)){let e=50>100*Math.random();window.__pubx__.abTestConfig={isABTestEnabled:!0,testBucket:e?"A":"B"}}}(e),e.pbNamespace.que.push(function(){window.__pubx__.logger=eC(e),ex(e.pbNamespace)}),window.__pubxGamQue__=[]},e5=(e,t)=>{window.__pubxLoaded__=e4(e.splitRate),e3(e,t)},e4=e=>(void 0===window.__pubxLoaded__&&(window.__pubxLoaded__=e>100*Math.random()),window.__pubxLoaded__),e6=e=>e.bids.some(({floorData:e})=>e&&e.floorProvider===t&&e.skipped),e2=e=>{let{floorData:o}=e;if(o&&o.floorProvider===t&&o.modelVersion)return o.modelVersion},e9=e=>{let t=e.bids.some(e2),o=e.bids.some(e=>{var t,o;return(null===(t=null==e?void 0:e.floorData)||void 0===t?void 0:t.skipRate)!==void 0&&(null===(o=null==e?void 0:e.floorData)||void 0===o?void 0:o.skipRate)<100});return t&&o},e8=(e,t,o)=>{if("object"!=typeof e||0===t.length){window.__pubx__.logger.error("setObjectValueFromKeyPath: invalid arguments",{object:e,keyPath:t,value:o});return}let i=t.length-1;for(let o=0;o<i;++o){let i=t[o];i in e||(e[i]={}),e=e[i]}e[t[i]]=o},e7=(e,t,o)=>{let i={},r=E(e);return r&&e===t.modelVersion&&e6(o)&&(r=`${r}-off`),r&&(i[t.pubxMvKey]=r),i},te=(e,t,o,i)=>{let r={},a=W(e,o,i);r[o.pubxFloorKey]=a;let n=E(t);if(n){let e=tt(a,n);r[o.pubxFloorMvKey]=e}return r},tt=(e,t)=>e+"-"+t,to=(e,t)=>e6(e)?t.pubxOptimizedOffValue:t.pubxOptimizedOnValue,ti=(e,t)=>{let o=e9(e);return t.isTimeoutSegregated&&P(e)?t.pubxSplitTimeoutValue:o?t.pubxSplitOnValue:t.pubxSplitOffValue},tr=(e,t,o)=>{let i={},r=ti(e,t);if(i[t.pubxSplitKey]=r,r!==t.pubxSplitOnValue)return i;let a=v(e,o);return t.modelVersion!==a&&(i[t.pubxOptimizedKey]=to(e,t)),i},ta=e=>{var t;let o={},i={enforceJSOn:"f_enf_on",enforceJSOff:"f_enf_off"},r=null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.testBucket,a="A"===r?e.pubxABSplitAKey:e.pubxABSplitBKey,n="A"===r?i.enforceJSOn:i.enforceJSOff;return o[a]=n,o},tn=(e,t,o,i,r)=>{let{remoteAucEvent:a}=r;e8(window.__pubxFloors__,[e,t,o],i),window.__pubx__.logger.debug("Setting KVs in Global",{auctionId:e,adUnitCode:t,key:o,value:i}),a({type:"gamTargeting",data:{adUnitCode:t,[o]:i}})},td=(e,t,o,i,r)=>{Object.entries(o).forEach(([o,i])=>{tn(t,e.code,o,i,r)})},ts=e=>e.split("__ayManagerEnv__")[0],tl=(e,t)=>e.bidder,tu=e=>{let t=s(e);return t.floors.additionalSchemaFields={bidder:tl},t},tc=e=>e>100*Math.random();var t_={};function tp(e){return e[0]+"x"+e[1]}function tg(e){return Array.isArray(e)&&2===e.length&&!isNaN(e[0])&&!isNaN(e[1])}t_=function(e,t,o,i,r){for(t=t.split?t.split("."):t,i=0;i<t.length;i++)e=e?e[t[i]]:r;return e===r?o:e};let tf=(e,t)=>e.getAdUnitPath()===t||e.getSlotElementId()===t;function tb(e){let t;if(window.googletag&&"function"==typeof window.googletag.pubads&&"function"==typeof window.googletag.pubads().getSlots)t=window.googletag.pubads().getSlots().find(t=>tf(t,e));return t}function tm(e){var t;let o=null===(t=window.__pubx__)||void 0===t?void 0:t.logger;try{let t=tb(e);if(t)return{gptSlot:t.getAdUnitPath(),divId:t.getSlotElementId()};return{}}catch(e){return null==o||o.error("getGptSlotInfoForAdUnitCode error:",e),null==o||o.remotePageError({code:J.UNCAUGHT_ERROR,payload:{name:e.name,message:e.message}}),{}}}(es=Q||(Q={}))[es.DESKTOP=0]="DESKTOP",es[es.MOBILE=1]="MOBILE",es[es.TABLET=2]="TABLET",(el=Z||(Z={}))[el.CHROME=0]="CHROME",el[el.FIREFOX=1]="FIREFOX",el[el.SAFARI=2]="SAFARI",el[el.EDGE=3]="EDGE",el[el.INTERNET_EXPLORER=4]="INTERNET_EXPLORER",el[el.OTHER=5]="OTHER",(eu=ee||(ee={}))[eu.WINDOWS=0]="WINDOWS",eu[eu.MAC=1]="MAC",eu[eu.LINUX=2]="LINUX",eu[eu.UNIX=3]="UNIX",eu[eu.IOS=4]="IOS",eu[eu.ANDROID=5]="ANDROID",eu[eu.OTHER=6]="OTHER";let tO=()=>{try{if(/ipad|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase()))return Q.TABLET;if(/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(navigator.userAgent.toLowerCase()))return Q.MOBILE;return Q.DESKTOP}catch(e){return Q.DESKTOP}},tR=()=>{try{if(/Edg/.test(navigator.userAgent))return Z.EDGE;if(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))return Z.CHROME;if(navigator.userAgent.match("CriOS"))return Z.CHROME;else if(/Firefox/.test(navigator.userAgent))return Z.FIREFOX;else if(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor))return Z.SAFARI;else if(/Trident/.test(navigator.userAgent)||/MSIE/.test(navigator.userAgent))return Z.INTERNET_EXPLORER;else return Z.OTHER}catch(e){return Z.OTHER}},th=()=>{try{if(-1!=navigator.userAgent.indexOf("Android"))return ee.ANDROID;if(-1!=navigator.userAgent.indexOf("like Mac"))return ee.IOS;if(-1!=navigator.userAgent.indexOf("Win"))return ee.WINDOWS;if(-1!=navigator.userAgent.indexOf("Mac"))return ee.MAC;if(-1!=navigator.userAgent.indexOf("Linux"))return ee.LINUX;if(-1!=navigator.appVersion.indexOf("X11"))return ee.UNIX;return ee.OTHER}catch(e){return ee.OTHER}};class tv{static getMetrics(e,t){return{bidderRT:this.getBidderRT(e,t),requestBidsRT:this.getRequestBidsRT(e)}}static getRequestBidsRT(e){let t={priceFloors:0,total:0};return["priceFloors","total"].forEach(o=>{let i=`requestBids.${o}`;void 0!==e[i]&&(t[o]=e[i])}),t}static getBidderRT(e,t){let o={};return t.forEach(t=>{let i=`adapters.client.${t}.total`;void 0!==e[i]?o[t]=Array.isArray(e[i])&&e[i][0]||0:o[t]=0}),o}}(ec=et||(et={})).BID_TIMEOUT="bidTimeout",ec.BID_RESPONSE="bidResponse",ec.BID_REJECTED="bidRejected",ec.AUCTION_END="auctionEnd",ec.BID_WON="bidWon";let tE=[et.BID_TIMEOUT,et.BID_RESPONSE,et.BID_REJECTED,et.AUCTION_END,et.BID_WON];class tA{constructor(e,t,o){var i;this.auctionCache={},this.auctionRankCounter=0,this.auctionIdMap=new Map,this.auctionRankMap=new Map,window.__pubx__=window.__pubx__||{},window.__pubx__.analytics={auctionCache:this.auctionCache,auctionIdMap:this.auctionIdMap},this.initOptions=Object.assign({samplingRate:1},e),this.config=o,this.prebidInstance=t,this.logger=null===(i=window.__pubx__)||void 0===i?void 0:i.logger}getWindowLocation(){var e;try{return(null===(e=window.top)||void 0===e?void 0:e.location)||window.location}catch(e){return this.logger.error("PubxAnalytics getWindowLocation error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),window.location}}getAdServerDataForBid(e){try{let t=(null==e?void 0:e.adUnitCode)||"",o=tb(t);if(o)return Object.fromEntries(o.getTargetingKeys().filter(e=>e.startsWith("pubx-")||e.startsWith("hb_")&&1===(e.match(/_/g)||[]).length).map(e=>[e,o.getTargeting(e)]));return{}}catch(e){return this.logger.error("PubxAnalytics getAdServerDataForBid error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}extractBid(e){var t;return{auctionId:this.getAuctionId(e.auctionId),adUnitCode:e.adUnitCode,gptSlotCode:tm(e.adUnitCode).gptSlot||null,bidderCode:e.bidder,cpm:e.cpm,originalCpm:e.originalCpm,originalCurrency:e.originalCurrency,creativeId:e.creativeId,dealId:e.dealId,currency:e.currency,floorData:e.floorData,mediaType:e.mediaType,netRevenue:e.netRevenue,requestTimestamp:e.requestTimestamp,responseTimestamp:e.responseTimestamp,status:e.status,sizes:(function(e){var t,o;let i=null===(t=window.__pubx__)||void 0===t?void 0:t.logger;try{return(o=e,"string"==typeof o?o.split(/\s*,\s*/).map(e=>e.match(/^(\d+)x(\d+)$/i)).filter(e=>null!==e).map(([e,t,o])=>[parseInt(t,10),parseInt(o,10)]):Array.isArray(o)?tg(o)?o.filter(tg):[o]:[]).map(tp)}catch(e){return null==i||i.error("parseSizesInput error:",e),null==i||i.remotePageError({code:J.UNCAUGHT_ERROR,payload:{name:e.name,message:e.message}}),[]}})(e.size).toString(),statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,bidId:e.bidId||e.requestId,placementId:e.params?((t=t_)&&t.__esModule?t.default:t)(e,"params.0.placementId"):null,source:e.source||"null"}}getAuctionId(e){try{if(!e)throw Error(`Missing auctionId(${e})provided to PubxAnalytics in bidResponse`);if(e&&"string"==typeof e&&ew(e))return e;if(e&&this.auctionIdMap.has(e))return this.auctionIdMap.get(e);let t=ey();return this.auctionIdMap.set(e,t),this.logger.debug("Generated new auctionId for invalid auctionId",{originalId:e,generatedId:t}),t}catch(t){if(this.logger.error("PubxAnalytics getAuctionId error:",t),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:t.name,message:t.message}}),!e)return ey();return e}}track(e,t){try{switch(e){case et.BID_TIMEOUT:t.map(this.extractBid.bind(this)).forEach(e=>{e.bidType=3,this.addBidToCache(e)});break;case et.BID_RESPONSE:let o=Object.assign(this.extractBid(t),{bidType:2});this.addBidToCache(o);break;case et.BID_REJECTED:let i=Object.assign(this.extractBid(t),{bidType:1});this.addBidToCache(i);break;case et.AUCTION_END:this.processAuctionEnd(t);break;case et.BID_WON:this.processBidWon(t)}}catch(e){this.logger.error("PubxAnalytics track error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}getConsentMetadata(){var e,t;try{return(null===(t=(e=this.prebidInstance).getConsentMetadata)||void 0===t?void 0:t.call(e))||{}}catch(e){return this.logger.error("PubxAnalytics getConsentMetadata error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}getUserIds(){var e,t;try{return(null===(t=(e=this.prebidInstance).getUserIds)||void 0===t?void 0:t.call(e))||{}}catch(e){return this.logger.error("PubxAnalytics getUserIds error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}addBidToCache(e){this.auctionCache[e.auctionId]||this.initializeAuctionCache(e.auctionId),this.auctionCache[e.auctionId].bids.push(e)}initializeAuctionCache(e){var t;let o=++this.auctionRankCounter;this.auctionRankMap.set(o,e),this.auctionCache[e]={bids:[],winningBids:[],auctionDetail:{auctionRank:o,auctionId:e,previousAuctionId:this.auctionRankMap.get(o-1)||null},floorDetail:{},adUnitDetails:[],pageDetail:{host:this.getWindowLocation().host,path:this.getWindowLocation().pathname,search:this.getWindowLocation().search},deviceDetail:{platform:navigator.platform,deviceType:tO(),deviceOS:th(),browser:tR()},userDetail:{userIdTypes:Object.keys(this.getUserIds())},consentDetail:{consentTypes:Object.keys(this.getConsentMetadata())},pmacDetail:{pmac_data:[]},extraData:(null===(t=window.__pubx__)||void 0===t?void 0:t.extraData)||{},initOptions:Object.assign(Object.assign({},this.initOptions),{auctionId:e}),sendAs:[],performanceMetrics:{}}}collectAuctionAdunitData(e){try{let t=this.getAuctionId(e.auctionId),o=e.bidderRequests,i=e.adUnits,r=new Map;for(let e of i){let t=e.code,o=Object.entries(e.mediaTypes||{}).reduce((e,[t,o])=>("video"===t&&(null==o?void 0:o.context)?e.push(`video:${o.context}`):e.push(t),e),[]);r.set(t,{adunitCode:t,gptSlotCode:tm(t).gptSlot||null,mediaTypes:o,bidders:[],refreshRank:void 0})}for(let e of o)for(let t of e.bids){if(!t.adUnitCode){this.logger.error("PubxAnalytics collectAuctionAdunitData error: Missing adUnitCode in bidderRequest",{bidderRequest:e});continue}let o=r.get(t.adUnitCode);o&&(o.bidders.push(t.bidder),o.refreshRank=t.auctionsCount||t.bidRequestsCount),r.set(t.adUnitCode,o)}this.auctionCache[t].adUnitDetails=Array.from(r.values())}catch(e){this.logger.error("PubxAnalytics collectAuctionAdunitData error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}collectAndStoreAuctionFeedbackData(e,t){try{let o=this.getAuctionId(e.auctionId),i=this.logger.makeRemoteAucError(e),r=this.logger.makeRemoteAucEvent(e),a={remoteAucError:i,remoteAucEvent:r},n=[];e.adUnits.forEach(i=>{let{adUnitStatus:r,originalBidCpmValue:d,bidCurrency:s,adserverTargeting:l,floorData:u,floorProvider:c,floorSkipStatus:_,floorModelVersion:p}=R(i,e,t,a),g={auctionId:o,auctionRank:this.auctionRankCounter,adUnitCode:i.code,status:r,bidCurrency:s,bidValue:d,pubCurrency:t.currency,adserverTargeting:l,floorData:m(u),floorProvider:c,floorSkipStatus:_,floorModelVersion:p};n.push(g)}),Object.assign(this.auctionCache[o].pmacDetail,{pmac_data:n})}catch(r){this.logger.error("PubxAnalytics collectAndStoreAuctionFeedbackData error:",r),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:r.name,message:r.message}});let o=this.getAuctionId(e.auctionId),i=e.adUnits.map(e=>({auctionId:o,auctionRank:this.auctionRankCounter,adUnitCode:e.code,pubCurrency:t.currency}));Object.assign(this.auctionCache[o].pmacDetail,{pmac_data:i})}}processAuctionEnd(e){var t,o;try{let i=this.getAuctionId(e.auctionId);this.auctionCache[i]||this.initializeAuctionCache(i),Object.assign(this.auctionCache[i].floorDetail,(null===(t=e.adUnits)||void 0===t?void 0:t.map(e=>{var t,o;return(null===(t=null==e?void 0:e.bids)||void 0===t?void 0:t.length)&&(null===(o=e.bids[0])||void 0===o?void 0:o.floorData)}).find(e=>e))||{}),this.auctionCache[i].deviceDetail.cdep=e.bidderRequests.map(e=>{var t,o,i;return null===(i=null===(o=null===(t=e.ortb2)||void 0===t?void 0:t.device)||void 0===o?void 0:o.ext)||void 0===i?void 0:i.cdep}).find(e=>e),Object.assign(this.auctionCache[i].auctionDetail,{adUnitCodes:(null===(o=e.adUnits)||void 0===o?void 0:o.map(e=>e.code))||[],timestamp:e.timestamp}),e.metrics&&e.metrics.getMetrics&&"function"==typeof e.metrics.getMetrics&&(this.auctionCache[i].performanceMetrics=function(e){var t,o;try{let i=(null===(t=e.metrics)||void 0===t?void 0:t.getMetrics())||{},r=(null===(o=e.bidderRequests)||void 0===o?void 0:o.map(e=>e.bidderCode))||[];return tv.getMetrics(i,r)}catch(e){return console.error("Error creating performance metrics:",e),tv.getMetrics({},[])}}(e)),this.collectAndStoreAuctionFeedbackData(e,this.config),this.collectAuctionAdunitData(e),this.prepareAuctionSend(i)}catch(e){this.logger.error("PubxAnalytics processAuctionEnd error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}processBidWon(e){try{let t=this.extractBid(e);this.auctionCache[t.auctionId]||this.initializeAuctionCache(t.auctionId);let o=this.auctionCache[t.auctionId].floorDetail;Object.assign(t,{floorProvider:(null==o?void 0:o.floorProvider)||null,floorFetchStatus:(null==o?void 0:o.fetchStatus)||null,floorLocation:(null==o?void 0:o.location)||null,floorModelVersion:(null==o?void 0:o.modelVersion)||null,floorSkipRate:(null==o?void 0:o.skipRate)||0,isFloorSkipped:(null==o?void 0:o.skipped)||!1,isWinningBid:!0,renderedSize:e.size,bidType:4,adServerData:this.getAdServerDataForBid(t)}),this.auctionCache[t.auctionId].winningBids.push(t),this.prepareSendWinningBids(t)}catch(e){this.logger.error("PubxAnalytics processBidWon error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}shouldFireEventRequest(e=""){var t;try{let o=null!==(t=this.initOptions.samplingRate)&&void 0!==t?t:1;return parseInt(function(e,t=0){let o=function(e,t){if("function"==typeof Math.imul)return Math.imul(e,t);var o=(4194303&e)*(t|=0);return 0xffc00000&e&&(o+=(0xffc00000&e)*t|0),0|o},i=0xdeadbeef^t,r=0x41c6ce57^t;for(let t=0,a;t<e.length;t++)i=o(i^(a=e.charCodeAt(t)),0x9e3779b1),r=o(r^a,0x5f356495);return i=o(i^i>>>16,0x85ebca6b)^o(r^r>>>13,0xc2b2ae35),(0x100000000*(2097151&(r=o(r^r>>>16,0x85ebca6b)^o(i^i>>>13,0xc2b2ae35)))+(i>>>0)).toString()}(e))%o==0}catch(e){return this.logger.error("PubxAnalytics shouldFireEventRequest error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),!1}}prepareSendWinningBids(e){try{let{auctionId:t}=e;if(!this.shouldFireEventRequest(t))return;let o=Object.assign({},this.auctionCache[t]);o.winningBid=e;let i={path:tA.winningBidPath,requiredKeys:["winningBid","pageDetail","deviceDetail","floorDetail","auctionDetail","userDetail","consentDetail","pmacDetail","extraData","initOptions","performanceMetrics"],eventType:"win"};this.sendData(i,o)}catch(e){this.logger.error("PubxAnalytics prepareSendWinningBids error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}prepareAuctionSend(e){try{if(!this.shouldFireEventRequest(e))return;let t=Object.assign({},this.auctionCache[e]),o={path:tA.auctionPath,requiredKeys:["bids","pageDetail","deviceDetail","floorDetail","auctionDetail","userDetail","adUnitDetails","consentDetail","pmacDetail","extraData","initOptions","performanceMetrics"],eventType:"auction"};if(this.auctionCache[e].sendAs.includes(o.eventType))return;this.sendData(o,t),this.auctionCache[e].sendAs.push(o.eventType)}catch(e){this.logger.error("PubxAnalytics prepareAuctionSend error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}sendData(e,t){try{var o,i;if(!e.requiredKeys.every(e=>!!t[e]))return;let r=((o={protocol:"https",hostname:this.initOptions.hostName||tA.defaultHost,pathname:e.path,search:{auctionTimestamp:t.auctionDetail.timestamp,pubxaiAnalyticsVersion:"v2.3.0",prebidVersion:this.prebidInstance.version.split("v")[1],pubxId:this.initOptions.pubxId}}).protocol||"http")+"://"+(o.host||o.hostname+(o.port?`:${o.port}`:""))+(o.pathname||"")+(o.search?`?${i=o.search||{},Object.keys(i).map(e=>Array.isArray(i[e])?i[e].map(t=>`${e}[]=${t}`).join("&"):`${e}=${i[e]}`).join("&")}`:"")+(o.hash?`#${o.hash}`:""),a=Object.fromEntries(e.requiredKeys.map(e=>[e,t[e]])),n=JSON.stringify([a]);fetch(r,{method:"POST",body:n,headers:{"Content-Type":"text/plain"}})}catch(e){this.logger.error("PubxAnalytics sendData error:",e),this.logger.remotePageError({code:J.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}setupPrebidListeners(){this.prebidInstance.onEvent("auctionEnd",e=>{this.track(et.AUCTION_END,e)}),this.prebidInstance.onEvent("bidResponse",e=>{this.track(et.BID_RESPONSE,e)}),this.prebidInstance.onEvent("bidRejected",e=>{this.track(et.BID_REJECTED,e)}),this.prebidInstance.onEvent("bidTimeout",e=>{this.track(et.BID_TIMEOUT,e)}),this.prebidInstance.onEvent("bidWon",e=>{this.track(et.BID_WON,e)})}logMissedEvents(){this.prebidInstance.getEvents().filter(e=>tE.includes(e.eventType)).forEach(e=>{this.track(e.eventType,e.args)})}initialise(){this.logMissedEvents(),this.setupPrebidListeners()}}tA.defaultHost="api.pbxai.com",tA.auctionPath="/analytics/auction",tA.winningBidPath="/analytics/bidwon",i().pbNsKeys.split(",").map(e=>M(e)).forEach(e=>{e5(e,"PB_GAM_GLOBAL_KVS"),function(e,t=!1){e.pbNamespace.que.push(()=>{var o;let i=null===(o=window.__pubx__)||void 0===o?void 0:o.logger;try{let o=e.pbNamespace,r=e.pbNamespace.version.replace("v","");if(t){null==i||i.debug("Prebid Analytics is enabled for Prebid version: ",r),n(e);return}null==i||i.debug("Pubx Analytics is enabled for Prebid version: ",r);let a={pubxId:e.pubxId,samplingRate:e.samplingRate};new tA(a,o,e).initialise()}catch(e){null==i||i.error("Error enabling analytics: ",e)}})}(e),l(e,tu),U(e),V(e,td),X(e)})})();